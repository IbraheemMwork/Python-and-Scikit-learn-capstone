<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Collaborative Filtering based recommender system using K Nearest Neighbor </title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 10px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.collection-content td {
	white-space: pre-wrap;
	word-break: break-word;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.callout img.notion-static-icon {
	width: 1em;
	height: 1em;
}

.callout p {
	margin: 0;
}

.callout h1,
.callout h2,
.callout h3 {
	margin: 0 0 0.6rem;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

blockquote.quote-large {
	font-size: 1.25em;
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray {
	color: rgba(125, 122, 117, 1);
	fill: rgba(125, 122, 117, 1);
}
.highlight-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.highlight-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.highlight-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.highlight-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.highlight-blue {
	color: rgba(56, 125, 201, 1);
	fill: rgba(56, 125, 201, 1);
}
.highlight-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.highlight-default_background {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray_background {
	background: rgba(42, 28, 0, 0.07);
}
.highlight-brown_background {
	background: rgba(139, 46, 0, 0.086);
}
.highlight-orange_background {
	background: rgba(224, 101, 1, 0.129);
}
.highlight-yellow_background {
	background: rgba(211, 168, 0, 0.137);
}
.highlight-teal_background {
	background: rgba(0, 100, 45, 0.09);
}
.highlight-blue_background {
	background: rgba(0, 124, 215, 0.094);
}
.highlight-purple_background {
	background: rgba(102, 0, 178, 0.078);
}
.highlight-pink_background {
	background: rgba(197, 0, 93, 0.086);
}
.highlight-red_background {
	background: rgba(223, 22, 0, 0.094);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(125, 122, 117, 1);
	fill: rgba(125, 122, 117, 1);
}
.block-color-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.block-color-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.block-color-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.block-color-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.block-color-blue {
	color: rgba(56, 125, 201, 1);
	fill: rgba(56, 125, 201, 1);
}
.block-color-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(240, 239, 237, 1);
}
.block-color-brown_background {
	background: rgba(245, 237, 233, 1);
}
.block-color-orange_background {
	background: rgba(251, 235, 222, 1);
}
.block-color-yellow_background {
	background: rgba(249, 243, 220, 1);
}
.block-color-teal_background {
	background: rgba(232, 241, 236, 1);
}
.block-color-blue_background {
	background: rgba(229, 242, 252, 1);
}
.block-color-purple_background {
	background: rgba(243, 235, 249, 1);
}
.block-color-pink_background {
	background: rgba(250, 233, 241, 1);
}
.block-color-red_background {
	background: rgba(252, 233, 231, 1);
}
.select-value-color-default { background-color: rgba(42, 28, 0, 0.07); }
.select-value-color-gray { background-color: rgba(28, 19, 1, 0.11); }
.select-value-color-brown { background-color: rgba(127, 51, 0, 0.156); }
.select-value-color-orange { background-color: rgba(196, 88, 0, 0.203); }
.select-value-color-yellow { background-color: rgba(209, 156, 0, 0.282); }
.select-value-color-green { background-color: rgba(0, 96, 38, 0.156); }
.select-value-color-blue { background-color: rgba(0, 118, 217, 0.203); }
.select-value-color-purple { background-color: rgba(92, 0, 163, 0.141); }
.select-value-color-pink { background-color: rgba(183, 0, 78, 0.152); }
.select-value-color-red { background-color: rgba(206, 24, 0, 0.164); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="29bb8fcf-a2cb-80bd-92ff-db2ea98978f6" class="page sans"><header><h1 class="page-title">Collaborative Filtering based recommender system using K Nearest Neighbor </h1><p class="page-description"></p></header><div class="page-body"><p id="29bb8fcf-a2cb-80d3-b06b-e151f79d091a" class="">Collaborative filtering is probably the most commonly used recommendation algorithm, there are two main types of methods:</p><ul id="29bb8fcf-a2cb-80d4-809c-d7be7280d89e" class="bulleted-list"><li style="list-style-type:disc"><strong>User-based</strong>¬†collaborative filtering is based on the user similarity or neighborhood</li></ul><ul id="29bb8fcf-a2cb-80ce-8fca-f5edc4405599" class="bulleted-list"><li style="list-style-type:disc"><strong>Item-based</strong>¬†collaborative filtering is based on similarity among items</li></ul><p id="29bb8fcf-a2cb-8075-a89f-e31f8eb79725" class="">They both work similarly, let&#x27;s briefly explain how user-based collaborative filtering works.</p><p id="29bb8fcf-a2cb-804b-91fe-f62beda6810c" class="">User-based collaborative filtering looks for users who are similar. This is very similar to the user clustering method done previously; where we employed explicit user profiles to calculate user similarity. However, the user profiles may not be available, so how can we determine if two users are similar?</p><p id="29bb8fcf-a2cb-8027-b606-cf52fe5c51c9" class=""><strong>User-item interaction matrix</strong></p><p id="29bb8fcf-a2cb-8034-b316-dfa2fe0c1e5a" class="">For most collaborative filtering-based recommender systems, the main dataset format is a 2-D matrix called the user-item interaction matrix. In the matrix, its row is labeled as the user id/index and column labelled to be the item id/index, and the element¬†<code>(i, j)</code>¬†represents the rating of user¬†<code>i</code>¬†to item¬†<code>j</code>.</p><p id="29bb8fcf-a2cb-80ca-b2c2-e8a1c646063a" class="">Below is a simple example of a user-item interaction matrix:</p><figure id="29bb8fcf-a2cb-8028-b2b8-ead8f0826de7" class="image"><a href="Collaborative%20Filtering%20based%20recommender%20system%20u/Screenshot_2025-10-28_at_9.47.15_PM.png"><img style="width:554.984375px" src="Collaborative%20Filtering%20based%20recommender%20system%20u/Screenshot_2025-10-28_at_9.47.15_PM.png"/></a></figure><p id="29bb8fcf-a2cb-80cb-be26-f0961ea252ac" class=""><strong>KNN-based collaborative filtering</strong></p><p id="29bb8fcf-a2cb-80b8-bbf7-d43bc6194fa0" class="">As we can see from above, each row vector represents the rating history of a user and each column vector represents the users who rated the item. A user-item interaction matrix is usually very sparse as you can imagine one user very likely only interacts with a very small subset of items and one item is very likely to be interacted by a small subset of users.</p><p id="29bb8fcf-a2cb-80fc-ac5f-fa06754e1409" class="">Now to determine if two users are similar, we can simply calculate the similarities between their row vectors in the interaction matrix. Then based on the similarity measurements, we can find the¬†<code>k</code>¬†nearest neighbor as the similar users.</p><p id="29bb8fcf-a2cb-8094-ad18-c3f25b23c771" class="">Item-based collaborative filtering works similarly, we just need to look at the user-item matrix vertically. Instead of finding similar users, we are trying to find similar items (courses). If two courses are enrolled by two groups of similar users, then we could consider the two items are similar and use the known ratings from the other users to predict the unknown ratings.</p><p id="29bb8fcf-a2cb-8004-94c6-e830bcdc7257" class="">If we formulate the KNN based collaborative filtering, the predicted rating of user¬†ùë¢¬†to item¬†ùëñ,¬†ùëüÃÇ¬†ùë¢ùëñ¬†is given by:</p><figure id="29bb8fcf-a2cb-807e-9638-e3638564b486" class="image"><a href="Collaborative%20Filtering%20based%20recommender%20system%20u/Screenshot_2025-10-28_at_9.48.46_PM.png"><img style="width:554.9921875px" src="Collaborative%20Filtering%20based%20recommender%20system%20u/Screenshot_2025-10-28_at_9.48.46_PM.png"/></a></figure><p id="29bb8fcf-a2cb-8069-af3e-d4354cf9b9b5" class="">Let&#x27;s illustrate how the equation works using a simple example. From the above figure, suppose we want to predict the rating of¬†<code>user6</code>¬†to item¬†<code>Machine Learning Capstone</code>¬†course. After some similarity measurements, we found that k = 4 nearest neighbors:¬†<code>user2, user3, user4, user5</code>¬†with similarities in array¬†<code>knn_sims</code>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29bb8fcf-a2cb-80da-ab69-de6ade44b6f4" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">import numpy as np 
import math</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29bb8fcf-a2cb-805d-a440-e729282a1c17" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">#an example similairty array stores the similarity of user2,user 3, user 4 and user 5 and 6
knn_sims = np.array([0.8, 0.92, 0.75, 0.83])</code></pre><p id="29bb8fcf-a2cb-8060-89b2-f1b04528f38b" class="">Also their rating on the¬†<code>Machine Learning Capstone</code>¬†course are:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29bb8fcf-a2cb-80d4-95fd-c3ecea3ab622" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all"># 2.0 means audit and 3.0 means complete the course
knn_rating = np.array([3.0, 3.0, 2.0, 3.0]) </code></pre><p id="29bb8fcf-a2cb-80bb-8bce-f41238c0185b" class="">So the predicted rating of¬†<code>user6</code>¬†to item¬†<code>Machine Learning Capstone</code>¬†course can be calculated as:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29bb8fcf-a2cb-80fb-868a-eb4f58dd47ab" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">r_u6_ml = np.dot(knn_sims, knn_ratings)/ sum(knn_sims)
r_u6_ml</code></pre><figure id="29bb8fcf-a2cb-8057-b19a-f3e279e9b6b7" class="image" style="text-align:left"><a href="Collaborative%20Filtering%20based%20recommender%20system%20u/Screenshot_2025-10-28_at_9.51.27_PM.png"><img style="width:424px" src="Collaborative%20Filtering%20based%20recommender%20system%20u/Screenshot_2025-10-28_at_9.51.27_PM.png"/></a></figure><p id="29bb8fcf-a2cb-80d9-a901-efe1146634fe" class="">If we already know the true rating to be 3.0, then we get a prediction error RMSE (Rooted Mean Squared Error) as:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29bb8fcf-a2cb-8078-bf93-ece350ddc3c7" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">true_rating = 3.0
rmse = math.sqrt(true_rating - r_u6_ml) ** 2
rmse</code></pre><figure id="29bb8fcf-a2cb-8027-9e87-c98e68b682f3" class="image" style="text-align:left"><a href="Collaborative%20Filtering%20based%20recommender%20system%20u/Screenshot_2025-10-28_at_9.52.20_PM.png"><img style="width:450px" src="Collaborative%20Filtering%20based%20recommender%20system%20u/Screenshot_2025-10-28_at_9.52.20_PM.png"/></a></figure><p id="29bb8fcf-a2cb-80ec-bd77-c2ed699f3bf9" class="">The predicted rating is around 2.7 (close to 3.0 with RMSE 0.22), which indicates that¬†<code>user6</code>¬†is also likely to complete the course¬†<code>Machine Learning Capstone</code>. As such, we may recommend it to user6 with high confidence.</p><p id="29bb8fcf-a2cb-8083-929c-fe1a0b61f329" class="">
</p><h1 id="29bb8fcf-a2cb-80a4-8d31-cd3d2ed02fe6" class="">Perform KNN-based collaborative filtering on the user-item interaction matrix</h1><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29bb8fcf-a2cb-80b8-bd1c-e3024fa27264" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">import pandas as pd</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29bb8fcf-a2cb-8011-98a6-d965b40be967" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">rating_url = &quot;&quot;https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBMSkillsNetwork-ML0321EN-Coursera/labs/v2/module_3/ratings.csv&quot;
rating_df = pd.read_csv(rating_url)</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29bb8fcf-a2cb-806d-a9c5-f34480916957" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">rating_df.head()</code></pre><figure id="29bb8fcf-a2cb-8011-9c93-ff080ad9fa37" class="image" style="text-align:left"><a href="Collaborative%20Filtering%20based%20recommender%20system%20u/Screenshot_2025-10-28_at_9.53.34_PM.png"><img style="width:336px" src="Collaborative%20Filtering%20based%20recommender%20system%20u/Screenshot_2025-10-28_at_9.53.34_PM.png"/></a></figure><p id="29bb8fcf-a2cb-805f-83be-f7943e123240" class="">The dataset contains three columns,¬†<code>user id</code>¬†(learner),¬†<code>item id</code>(course), and¬†<code>rating</code>(enrollment mode).</p><p id="29bb8fcf-a2cb-802e-81fc-f32a2e44f926" class="">Note that this matrix is presented as the dense or vertical form, and you may convert it to a sparse matrix using¬†<code>pivot</code>¬†:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29bb8fcf-a2cb-80d4-9d08-e87ebed5d3e1" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">rating_sparse_df = rating_df.pivot(index=&#x27;user&#x27;, columns=&#x27;item&#x27;,values = &#x27;rating&#x27;).fillna(0).reset_index().rename_axis(index=None, columns = None)
rating_sparse_df.head()</code></pre><figure id="29bb8fcf-a2cb-80a7-a835-e4da9f9a6dc4" class="image"><a href="Collaborative%20Filtering%20based%20recommender%20system%20u/Screenshot_2025-10-28_at_9.55.18_PM.png"><img style="width:554.984375px" src="Collaborative%20Filtering%20based%20recommender%20system%20u/Screenshot_2025-10-28_at_9.55.18_PM.png"/></a></figure><p id="29bb8fcf-a2cb-8001-8216-c5c9ee617028" class="">Usually, the dense format is more preferred as it saves a lot of storage and memory space. While the benefit of the sparse matrix is it is in the nature matrix format and you could apply computations such as cosine similarity directly.</p><p id="29bb8fcf-a2cb-80ed-bbda-c70071d38fa0" class="">Next, you need to perform KNN-based collaborative filtering on the user-item interaction matrix. You may choose one of the two following implementation options of KNN-based collaborative filtering.</p><ul id="29bb8fcf-a2cb-80e1-b26f-d3d14c1e4d96" class="bulleted-list"><li style="list-style-type:disc">The first one is to use¬†<code>scikit-surprise</code>¬†which is a popular and easy-to-use Python recommendation system library.</li></ul><ul id="29bb8fcf-a2cb-80a6-9f9b-fd6e56e85bc6" class="bulleted-list"><li style="list-style-type:disc">The second way is to implement it with standard¬†<code>numpy</code>,¬†<code>pandas</code>, and¬†<code>sklearn</code>. You may need to write a lot of low-level implementation code along the way.</li></ul><h2 id="29bb8fcf-a2cb-80d5-b000-f56c58a8f266" class="">Implementation Option 1: use Suprise library(recommended) </h2><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29bb8fcf-a2cb-80b5-bf72-d6a136190cbf" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">!pip install scikit-suprise</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29bb8fcf-a2cb-8017-a86f-f76084923ff6" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">from suprise import KNNBasic
from suprise import Dataset, Reader
from suprise.model_selection import train_test_split
from suprise import accuracy </code></pre><p id="29bb8fcf-a2cb-809d-8ea5-f71efc013fd1" class="">Then, let&#x27;s take a look at a code example how easily to perform KNN collaborative filtering on a sample movie review dataset, which contains about 100k movie ratings from users.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29bb8fcf-a2cb-8088-a196-c90f687f3cfc" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">data = Dataset.load_builtin(&#x27;ml-100k&#x27;, prompt=False(

trainset, testset = train_test_split(data, test_size = .25)

algo = KNNBasic()

algo.fit(trainset)
predictions = algo.test(testset)

accuracy.rmse(predictions)</code></pre><figure id="29bb8fcf-a2cb-80b6-85b8-e363809a1b26" class="image"><a href="Collaborative%20Filtering%20based%20recommender%20system%20u/Screenshot_2025-10-28_at_9.59.23_PM.png"><img style="width:396px" src="Collaborative%20Filtering%20based%20recommender%20system%20u/Screenshot_2025-10-28_at_9.59.23_PM.png"/></a></figure><p id="29bb8fcf-a2cb-800e-a828-f1ea3e8ebaf7" class="">As you can see, just a couple of lines and you can apply KNN collaborative filtering on the sample movie lens dataset. The main evaluation metric is¬†<code>Root Mean Square Error (RMSE)</code>¬†which is a very popular rating estimation error metric used in recommender systems as well as many regression model evaluations.</p><p id="29bb8fcf-a2cb-80c5-b9b2-ffb8d8d1ddce" class="">now let&#x27;s load our own course rating dataset:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29bb8fcf-a2cb-80ad-883c-dfe75173cc88" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">#save the rating data frame to a csv file
rating_df.to_csv(&quot;course_ratings.csv&quot;, index=False)

#read the course rating dataset with columns user item rating 
reader = Reader(line_format= &#x27;user item rating&#x27;, 
								sep = &#x27;,&#x27;,
								skip_lines = 1,
								rating_scale= (2,3))
	
#load the data								
course_dataset = Dataset.load_from_file(&quot;course_ratings.csv&quot;, reader=reader)</code></pre><p id="29bb8fcf-a2cb-80f6-a6d1-e1e6cc6399a9" class="">We split it into trainset and testset:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29bb8fcf-a2cb-8021-96b2-e65c5baa9eea" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">trainset, testset = train_test_split(course_dataset, test_size = .3)</code></pre><p id="29bb8fcf-a2cb-80d2-9e29-db121c518b79" class="">then check how many users and items we can use to fit a KNN model:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29bb8fcf-a2cb-8043-afaf-ee2589b23499" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">printf&quot; total {trainset.n_user} users and {trainset.n_items} items in the trainingset&quot;)</code></pre><figure id="29bb8fcf-a2cb-8065-a6ce-db1e4e5fa1ae" class="image"><a href="Collaborative%20Filtering%20based%20recommender%20system%20u/Screenshot_2025-10-28_at_10.05.10_PM.png"><img style="width:554.9765625px" src="Collaborative%20Filtering%20based%20recommender%20system%20u/Screenshot_2025-10-28_at_10.05.10_PM.png"/></a></figure><p id="29bb8fcf-a2cb-8088-8f93-ffccfd43308d" class="">
</p><p id="29bb8fcf-a2cb-8033-8baa-feab1f69a3ee" class=""><strong>TASK: Perform KNN-based collaborative filtering on the user-item interaction matrix</strong></p><p id="29bb8fcf-a2cb-8028-b65f-f6301cf81062" class=""><em>TODO: Fit the KNN-based collaborative filtering model using the trainset and evaluate the results using the testset:</em></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29bb8fcf-a2cb-8035-84cd-dbc9699f24c4" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">sim_option = {&#x27;name&#x27;:&#x27;cosine&#x27;, &#x27;user_based&#x27;: False,}

model_knn = KNNBasic(sim_option = sim_option)

model_knn.fit(trainset)

pred = model_knn.predict(testset)

accuracy.rmse(pred)</code></pre><p id="29bb8fcf-a2cb-80f5-8d79-d73fcc6feedf" class="">output dies cause kernel issue online</p><p id="29bb8fcf-a2cb-805e-84ff-ee919862e757" class="">its supposed to return the RMSE </p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>